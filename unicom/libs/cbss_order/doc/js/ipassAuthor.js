function isIpassConnected(){var a="";try{initIpassObj(),UniContrl.ContName="CCITCont1",UniContrl.providerName="CCIT Smartcard CSP V1.0";try{var b=""!=readIpassKeyNo();if(!b)return 3;UniContrl.keySpec=KT_SIGNATURE,a=UniContrl.readCert("CCITCont1")}catch(c){var d=dec2hex(c.number);return 0xffffffffe0050000==d||0xffffffff80040000==d||0xffffffff800d0000==d?2:0xffffffff800a0000==d||0xffffffffe0060000==d?3:2}return""!=a?1:2}catch(c){var d=dec2hex(c.number);return 3}}function readIpassKeyNo(){try{initIpassObj();var a=UniContrl.readUKSN();return""==a||null==a||a===void 0?"":a}catch(b){return""}}function ukey(){var b,c,a={};if(initIpassObj(),!test())return a.code=9e3,a.message="\u8bf7\u5b89\u88c5iPASS\u5ba2\u6237\u7aef\u63a7\u4ef6\u540e\u91cd\u8bd5!",a;try{UniContrl.ContName="CCITCont1",UniContrl.providerName="CCIT Smartcard CSP V1.0"}catch(d){var e=dec2hex(d.number);return"TypeError"==d.name?(a.code=9e3,a.message="\u8bf7\u5b89\u88c5iPASS\u5ba2\u6237\u7aef\u63a7\u4ef6\u540e\u91cd\u8bd5!",a):0xffffffffe0060000==e||0xffffffff800d0000==e||0xffffffff80040000==e?(a.code=9001,a.message="\u8bf7\u63d2\u5165iPASS\u540e\u91cd\u8bd5!",a):0xffffffff80140000==e?(a.code=9005,a.message="\u8bf7\u8f93\u5165iPASS\u53e3\u4ee4\uff0c\u5982\u9057\u5fd8\u53e3\u4ee4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u89e3\u9501!",a):(a.code=9009,a.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",a)}try{if(b=UniContrl.readUKSN(),""==b||null==b||b===void 0)return a.code=9006,a.message="iPASS\u4e0d\u80fd\u4f7f\u7528,\u8bf7\u4f7f\u7528\u5408\u6cd5iPASS!",a}catch(d){return a.code=9006,a.message="iPASS\u4e0d\u80fd\u4f7f\u7528,\u8bf7\u4f7f\u7528\u5408\u6cd5iPASS!",a}try{if(c=getSerialNumber(),""==c){var f;return UniContrl.keySpec=KT_SIGNATURE,f=UniContrl.genRSAKeyPair(1024),a.code=2,a.message="9003$ipassKeyNo::"+b+";pubkey::"+f+";optime::"+(new Date).getTime(),a}try{us=UniContrl.getPriData()}catch(d){us=""}var g=b+(new Date).getTime();UniContrl.keySpec=KT_SIGNATURE;var h=UniContrl.signature(g,DT_UNENCODING,"");return""==h||null==h||h===void 0?(a.code=9009,a.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",a):(a.code=1,a.message="9004$ipassKeyNo::"+b+";signature::"+h+";certSn::"+c+";randomNum::"+g+";us::"+us,a)}catch(d){var e=dec2hex(d.number);return 0xffffffff80040000==e||0xffffffff80040000==e||0xffffffff80140000==e?(a.code=9005,a.message="\u8bf7\u8f93\u5165iPASS\u53e3\u4ee4\uff0c\u5982\u9057\u5fd8\u53e3\u4ee4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u89e3\u9501!",a):(a.code=9009,a.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",a)}}function sign(a){var c,b={};if(null==a||""==a)return b.code=9008,b.message="\u7b7e\u540d\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u4e1a\u52a1\u4fe1\u606f\u662f\u5426\u586b\u5199\u5b8c\u6574!",b;initIpassObj();try{UniContrl.ContName="CCITCont1",UniContrl.providerName="CCIT Smartcard CSP V1.0"}catch(e){var f=dec2hex(e.number);return"TypeError"==e.name?(b.code=9e3,b.message="\u8bf7\u5b89\u88c5iPASS\u5ba2\u6237\u7aef\u63a7\u4ef6\u540e\u91cd\u8bd5!",b):0xffffffffe0060000==f||0xffffffff800d0000==f||0xffffffff80040000==f?(b.code=9001,b.message="\u8bf7\u63d2\u5165iPASS\u540e\u91cd\u8bd5!",b):0xffffffff80140000==f?(b.code=9005,b.message="\u8bf7\u8f93\u5165iPASS\u53e3\u4ee4\uff0c\u5982\u9057\u5fd8\u53e3\u4ee4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u89e3\u9501!",b):(b.code=9009,b.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",b)}try{if(c=UniContrl.readUKSN(),""==c||null==c||c===void 0)return b.code=9006,b.message="iPASS\u4e0d\u80fd\u4f7f\u7528,\u8bf7\u4f7f\u7528\u5408\u6cd5iPASS!",b}catch(e){return b.code=9006,b.message="iPASS\u4e0d\u80fd\u4f7f\u7528,\u8bf7\u4f7f\u7528\u5408\u6cd5iPASS!",b}try{UniContrl.keySpec=KT_SIGNATURE;var g=(new Date).getTime();a=srcFormat(a)+""+g+c;var h=UniContrl.SignatrueEx(a);return""==h||null==h||h===void 0?(b.code=9009,b.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",b):(b.code=1,b.message="optype::1;ipassKeyNo::"+c+";t::"+g+";signature::"+h,b)}catch(e){var f=dec2hex(e.number);return 0xffffffff800a0000==f||0xffffffff80040000==f?(b.code=9007,b.message="\u7b7e\u540d\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u63d2\u5165\u7684iPASS\u662f\u5426\u6b63\u786e!",b):0xffffffff80040000==f||0xffffffff80040000==f||0xffffffff80140000==f?(b.code=9005,b.message=f+"\u8bf7\u8f93\u5165iPASS\u53e3\u4ee4\uff0c\u5982\u9057\u5fd8\u53e3\u4ee4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u89e3\u9501!",b):(b.code=9009,b.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",b)}}function installcert(a){initIpassObj();var b={};if(""==a)return b.code=9999,b.message="\u8bc1\u4e66\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a\uff01",b;try{UniContrl.ContName="CCITCont1",UniContrl.providerName="CCIT Smartcard CSP V1.0";var c="2938472";if(c=UniContrl.genRandNum(6),start=0,end=a.indexOf("    ",start),end>1){var d=downloadDouble(a,c);d||(b.code=9014,b.message="\u8bc1\u4e66\u5b89\u88c5\u5931\u8d25!")}else{var e=0!=UniContrl.needPartner;UniContrl.keySpec=KT_SIGNATURE,e&&(UniContrl.OnApplyCert(c),UniContrl.OnPreDownloadCert(c)),UniContrl.saveCertWithMatchPriKey(a),e&&(UniContrl.SetPrompt(1),UniContrl.OnDownloadCert(c))}return b.code=1,b.message="\u64cd\u4f5c\u6210\u529f!",b}catch(f){var g=dec2hex(f.number);return 0xffffffffe0060000==g?(b.code=9001,b.message="\u8bf7\u63d2\u5165iPASS\u540e\u91cd\u8bd5!"+g,b):0xffffffff800d0000==g||184467440715622e5==g?(b.code=9011,b.message="iPASS\u4e0d\u6b63\u786e,\u8bf7\u786e\u8ba4\u60a8\u7684\u7535\u8111\u4e0a\u53ea\u6709\u4e00\u4e2aiPASS\uff01",b):0xffffffff800d0000==g?(b.code=9011,b.message="iPASS\u4e0d\u6b63\u786e,\u8bf7\u786e\u8ba4\u60a8\u7684\u7535\u8111\u4e0a\u53ea\u6709\u4e00\u4e2aiPASS\uff01",b):0xffffffff80040000==g?(b.code=9011,b.message="iPASS\u4e0d\u6b63\u786e,\u8bf7\u786e\u8ba4\u60a8\u7684\u7535\u8111\u4e0a\u53ea\u6709\u4e00\u4e2aiPASS\uff01",b):(b.code=9009,b.message="iPASS\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u5173\u95ed\u6d4f\u89c8\u5668\u91cd\u8bd5!",b)}}function downloadDouble(a,b){var c,d,e,f,g,h,i;return i=0!=UniContrl.needPartner,i&&(UniContrl.OnApplyCert(b),UniContrl.OnPreDownloadCert(b)),h=a,f=0,g=h.indexOf("    ",f),0>=g?!1:(c=h.substring(f,g),f=g+4,g=h.indexOf("    ",f),0>=g?!1:(d=h.substring(f,g),f=g+4,e=h.substring(f,h.length),UniContrl.keySpec=KT_SIGNATURE,UniContrl.saveCertWithMatchPriKey(c),i&&(UniContrl.SetPrompt(0),UniContrl.OnDownloadCert(b)),UniContrl.keySpec=KT_EXCHANGE,UniContrl.saveKeyPairEX(UniContrl.getCertPubKey(d),e,KET_ENCBYSIGNKEY),UniContrl.saveCertWithMatchPriKey(d),i&&(UniContrl.SetPrompt(1),UniContrl.OnDownloadCert(b)),!0))}function dec2hex(a){var b,d,c="0123456789ABCDEF";for(d=0,b="";16>d;)i=15&a,b=c.substring(i,i+1)+b,a>>=4,d+=1;return b="0x"+b}function getSerialNumber(){try{var a,b;return UniContrl.keySpec=KT_SIGNATURE,a=UniContrl.readCert("CCITCont1"),b=UniContrl.getCertSN(a)}catch(c){return""}}function initIpassObj(){inited||(document.body.insertAdjacentHTML("beforeEnd",' 	    <object id="UniContrl" classid="CLSID:53D862EE-09DC-4F89-8697-62DCE5C989B8" width="0" height="0"> 	    </object>'),inited=!0)}function test(){try{var a;return a=UniContrl.GetControlVersion(),""==a||null==a||a===void 0?!1:!0}catch(b){return!1}}function srcFormat(a){for(var b=RegExp('"'),c=RegExp("[()|{}',&\\[\\]]"),d="",e=0;a.length>e;e++)d+=a.substr(e,1).replace(c,"").replace(b,"");return d}var DT_UNENCODING=0,DT_BASE64=1,KT_SIGNATURE=0,KT_EXCHANGE=1,KET_UNENCRYPT=0,KET_ENCBYSIGNKEY=1,inited=!1; 